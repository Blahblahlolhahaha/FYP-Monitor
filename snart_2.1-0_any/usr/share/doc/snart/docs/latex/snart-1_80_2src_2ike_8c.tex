\hypertarget{snart-1_80_2src_2ike_8c}{}\doxysection{snart-\/1.0/src/ike.c File Reference}
\label{snart-1_80_2src_2ike_8c}\index{snart-\/1.0/src/ike.c@{snart-\/1.0/src/ike.c}}
{\ttfamily \#include \char`\"{}../include/ike.\+h\char`\"{}}\newline
Include dependency graph for ike.\+c\+:
% FIG 0
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a792b620aa4b8136af70a50f8bce857fe}{get\+\_\+response\+\_\+flag}} (struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$hdr)
\item 
int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a71b42980feec6f86f3022ec85e95c49a}{get\+\_\+version\+\_\+flag}} (struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$hdr)
\item 
int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a40bff66ff31f379f50f35fe368f5e149}{get\+\_\+initiator\+\_\+flag}} (struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$hdr)
\item 
char $\ast$ \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a354dde6d2340e5858058e7834ef1113e}{get\+\_\+exchange\+\_\+type}} (struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$hdr)
\item 
char $\ast$ \mbox{\hyperlink{snart-1_80_2src_2ike_8c_aca25809fa65a72203c1a86df82023717}{get\+\_\+ike\+\_\+payload\+\_\+type}} (struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$hdr)
\item 
char $\ast$ \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a90f5619eb873d81ae5ae37721698a5ea}{get\+\_\+nxt\+\_\+payload}} (struct \mbox{\hyperlink{structisakmp__payload__hdr}{isakmp\+\_\+payload\+\_\+hdr}} $\ast$hdr)
\item 
void \mbox{\hyperlink{snart-1_80_2src_2ike_8c_ac41f892693e060bc5b9eb439ceb338e1}{print\+\_\+isakmp\+\_\+headers\+\_\+info}} (struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$isakmp\+\_\+hdr)
\item 
int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_aef3b3dbce39005a3cbc9cea26d24f6b1}{analyse\+\_\+\+SA}} (struct rte\+\_\+mbuf $\ast$pkt, uint16\+\_\+t offset, struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$isakmp\+\_\+hdr, struct rte\+\_\+ipv4\+\_\+hdr $\ast$ipv4\+\_\+hdr)
\item 
int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a2c592dd802224ee99f524302c7094fa5}{analyse\+\_\+\+KE}} (struct rte\+\_\+mbuf $\ast$pkt, uint16\+\_\+t offset, struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$isakmp\+\_\+hdr, struct rte\+\_\+ipv4\+\_\+hdr $\ast$ipv4\+\_\+hdr)
\item 
int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a4efb58d15e0fc8def5b9b460204df033}{analyse\+\_\+\+SK}} (struct rte\+\_\+mbuf $\ast$pkt, uint16\+\_\+t offset, struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$isakmp\+\_\+hdr, struct rte\+\_\+ipv4\+\_\+hdr $\ast$ipv4\+\_\+hdr)
\item 
int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a19043d6849f4fa4dcf23be3a5cb3a9f7}{analyse\+\_\+N}} (struct rte\+\_\+mbuf $\ast$pkt, uint16\+\_\+t offset, struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$isakmp\+\_\+hdr, struct rte\+\_\+ipv4\+\_\+hdr $\ast$ipv4\+\_\+hdr)
\item 
int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_ae41bc3b411341be3c36c5f3883534a6b}{analyse\+\_\+\+C\+E\+RT}} (struct rte\+\_\+mbuf $\ast$pkt, uint16\+\_\+t offset, struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$isakmp\+\_\+hdr, struct rte\+\_\+ipv4\+\_\+hdr $\ast$ipv4\+\_\+hdr)
\item 
int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a9a526d19c84f4e99f0b4460845258dfb}{get\+\_\+proposals}} (struct rte\+\_\+mbuf $\ast$pkt, uint16\+\_\+t offset, char $\ast$$\ast$$\ast$proposals, int $\ast$\mbox{\hyperlink{structcheck}{check}})
\item 
void \mbox{\hyperlink{snart-1_80_2src_2ike_8c_ae5ac8407bb0a2effa8426c630f692914}{get\+\_\+transformations}} (struct rte\+\_\+mbuf $\ast$pkt, int offset, int size, char $\ast$buf, int $\ast$\mbox{\hyperlink{structcheck}{check}})
\item 
void \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a4f2f0ec7403dcc0f2227f94c985daf56}{delete\+\_\+tunnel}} (uint64\+\_\+t initiator\+\_\+spi, uint64\+\_\+t responder\+\_\+spi, int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a101d35b91670cc48b8670704e925e797}{src\+\_\+addr}}, int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_ae05dcdd7389336890e7d407337c207ed}{dst\+\_\+addr}})
\item 
int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a8dda2cc4ea685715608d01a5080022bd}{check\+\_\+ike\+\_\+spi}} (uint64\+\_\+t initiator\+\_\+spi, uint64\+\_\+t responder\+\_\+spi, int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a101d35b91670cc48b8670704e925e797}{src\+\_\+addr}}, int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_ae05dcdd7389336890e7d407337c207ed}{dst\+\_\+addr}}, struct \mbox{\hyperlink{structtunnel}{tunnel}} $\ast$\mbox{\hyperlink{structtunnel}{tunnel}})
\item 
int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a8a2e4d2381a97d21c0ed7edf51f25bd3}{check\+\_\+if\+\_\+tunnel\+\_\+exists}} (struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$isakmp\+\_\+hdr, struct rte\+\_\+ipv4\+\_\+hdr $\ast$ipv4\+\_\+hdr)
\item 
void \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a46e5b81cb72db9afd48cf130849cb156}{get\+\_\+ip\+\_\+address\+\_\+string}} (rte\+\_\+be32\+\_\+t ip\+\_\+address, char $\ast$ip)
\item 
void \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a590a7051b45b08f85cbf438873f357bd}{add\+\_\+tunnel}} (struct \mbox{\hyperlink{structtunnel}{tunnel}} $\ast$add)
\item 
void \mbox{\hyperlink{snart-1_80_2src_2ike_8c_ab0b298c3f8e167dd65ab193d8a3b5eae}{remove\+\_\+tunnel}} (struct \mbox{\hyperlink{structtunnel}{tunnel}} $\ast$remove)
\item 
void \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a90b40012e2e402c28879829f2f10a4fb}{load\+\_\+tunnel}} ()
\item 
void \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a3f46e5ca9859c8654d91b889ac04c9f6}{get\+\_\+ipv6\+\_\+address\+\_\+string}} (struct rte\+\_\+ipv6\+\_\+hdr $\ast$hdr, char $\ast$src\+\_\+ip, char $\ast$dst\+\_\+ip)
\item 
int \mbox{\hyperlink{snart-1_80_2src_2ike_8c_abc1b7b2bfaf346c3f411effd1df87d4f}{analyse\+\_\+isakmp\+\_\+payload}} (struct rte\+\_\+mbuf $\ast$pkt, struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$isakmp\+\_\+hdr, struct rte\+\_\+ipv4\+\_\+hdr $\ast$ipv4\+\_\+hdr, uint16\+\_\+t offset, int nxt\+\_\+payload)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
char \mbox{\hyperlink{snart-1_80_2src_2ike_8c_a101d35b91670cc48b8670704e925e797}{src\+\_\+addr}} \mbox{[}16\mbox{]}
\item 
char \mbox{\hyperlink{snart-1_80_2src_2ike_8c_ae05dcdd7389336890e7d407337c207ed}{dst\+\_\+addr}} \mbox{[}16\mbox{]}
\item 
char \mbox{\hyperlink{snart-1_80_2src_2ike_8c_adafcb47aa03cf3507a3fdfe899d1001d}{current\+\_\+time}} \mbox{[}21\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a590a7051b45b08f85cbf438873f357bd}\label{snart-1_80_2src_2ike_8c_a590a7051b45b08f85cbf438873f357bd}} 
\index{ike.c@{ike.c}!add\_tunnel@{add\_tunnel}}
\index{add\_tunnel@{add\_tunnel}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{add\_tunnel()}{add\_tunnel()}}
{\footnotesize\ttfamily void add\+\_\+tunnel (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structtunnel}{tunnel}} $\ast$}]{add }\end{DoxyParamCaption})}

Add tunnels to established tunnel array 
\begin{DoxyParams}{Parameters}
{\em tunnel} & tunnel to add \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_ae41bc3b411341be3c36c5f3883534a6b}\label{snart-1_80_2src_2ike_8c_ae41bc3b411341be3c36c5f3883534a6b}} 
\index{ike.c@{ike.c}!analyse\_CERT@{analyse\_CERT}}
\index{analyse\_CERT@{analyse\_CERT}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{analyse\_CERT()}{analyse\_CERT()}}
{\footnotesize\ttfamily int analyse\+\_\+\+C\+E\+RT (\begin{DoxyParamCaption}\item[{struct rte\+\_\+mbuf $\ast$}]{pkt,  }\item[{uint16\+\_\+t}]{offset,  }\item[{struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$}]{isakmp\+\_\+hdr,  }\item[{struct rte\+\_\+ipv4\+\_\+hdr $\ast$}]{ipv4\+\_\+hdr }\end{DoxyParamCaption})}

Analyses a Certificate/\+Certificate request payload 
\begin{DoxyParams}{Parameters}
{\em pkt} & \+: pointer to packet used \\
\hline
{\em offset} & offset to paylaod header \\
\hline
{\em isakmp\+\_\+hdr} & pointer to isakmp headers \\
\hline
{\em ipv4\+\_\+hdr} & pointer to ipv4 headers \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if there are no errors analyzing the packet, 0 if otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_abc1b7b2bfaf346c3f411effd1df87d4f}\label{snart-1_80_2src_2ike_8c_abc1b7b2bfaf346c3f411effd1df87d4f}} 
\index{ike.c@{ike.c}!analyse\_isakmp\_payload@{analyse\_isakmp\_payload}}
\index{analyse\_isakmp\_payload@{analyse\_isakmp\_payload}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{analyse\_isakmp\_payload()}{analyse\_isakmp\_payload()}}
{\footnotesize\ttfamily int analyse\+\_\+isakmp\+\_\+payload (\begin{DoxyParamCaption}\item[{struct rte\+\_\+mbuf $\ast$}]{pkt,  }\item[{struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$}]{isakmp\+\_\+hdr,  }\item[{struct rte\+\_\+ipv4\+\_\+hdr $\ast$}]{ipv4\+\_\+hdr,  }\item[{uint16\+\_\+t}]{offset,  }\item[{int}]{nxt\+\_\+payload }\end{DoxyParamCaption})}

Analyzes payload within an isakmp packet. Note that this function is recursive in nature and will continue until nxt\+\_\+payload is 0 
\begin{DoxyParams}{Parameters}
{\em pkt} & Pointer to packet buffer to be analyzed \\
\hline
{\em isakmp\+\_\+hdr} & pointer to isakmp headers in a packet \\
\hline
{\em offset} & to start analyzing \\
\hline
{\em nxt\+\_\+payload} & Should take from isakmp\+\_\+hdr or payload\+\_\+hdr \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if packet is legit, 0 if otherrwise 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a2c592dd802224ee99f524302c7094fa5}\label{snart-1_80_2src_2ike_8c_a2c592dd802224ee99f524302c7094fa5}} 
\index{ike.c@{ike.c}!analyse\_KE@{analyse\_KE}}
\index{analyse\_KE@{analyse\_KE}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{analyse\_KE()}{analyse\_KE()}}
{\footnotesize\ttfamily int analyse\+\_\+\+KE (\begin{DoxyParamCaption}\item[{struct rte\+\_\+mbuf $\ast$}]{pkt,  }\item[{uint16\+\_\+t}]{offset,  }\item[{struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$}]{isakmp\+\_\+hdr,  }\item[{struct rte\+\_\+ipv4\+\_\+hdr $\ast$}]{ipv4\+\_\+hdr }\end{DoxyParamCaption})}

Analyses a Key Exchange payload 
\begin{DoxyParams}{Parameters}
{\em pkt} & \+: pointer to packet used \\
\hline
{\em offset} & offset to paylaod header \\
\hline
{\em isakmp\+\_\+hdr} & pointer to isakmp headers \\
\hline
{\em ipv4\+\_\+hdr} & pointer to ipv4 headers \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if there are no errors analyzing the packet, 0 if otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a19043d6849f4fa4dcf23be3a5cb3a9f7}\label{snart-1_80_2src_2ike_8c_a19043d6849f4fa4dcf23be3a5cb3a9f7}} 
\index{ike.c@{ike.c}!analyse\_N@{analyse\_N}}
\index{analyse\_N@{analyse\_N}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{analyse\_N()}{analyse\_N()}}
{\footnotesize\ttfamily int analyse\+\_\+N (\begin{DoxyParamCaption}\item[{struct rte\+\_\+mbuf $\ast$}]{pkt,  }\item[{uint16\+\_\+t}]{offset,  }\item[{struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$}]{isakmp\+\_\+hdr,  }\item[{struct rte\+\_\+ipv4\+\_\+hdr $\ast$}]{ipv4\+\_\+hdr }\end{DoxyParamCaption})}

Analyses a Notify payload. If an error code is sent, should kill sesssion i think? 
\begin{DoxyParams}{Parameters}
{\em pkt} & \+: pointer to packet used \\
\hline
{\em offset} & offset to paylaod header \\
\hline
{\em isakmp\+\_\+hdr} & pointer to isakmp headers \\
\hline
{\em ipv4\+\_\+hdr} & pointer to ipv4 headers \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if there are no errors analyzing the packet, 0 if otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_aef3b3dbce39005a3cbc9cea26d24f6b1}\label{snart-1_80_2src_2ike_8c_aef3b3dbce39005a3cbc9cea26d24f6b1}} 
\index{ike.c@{ike.c}!analyse\_SA@{analyse\_SA}}
\index{analyse\_SA@{analyse\_SA}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{analyse\_SA()}{analyse\_SA()}}
{\footnotesize\ttfamily int analyse\+\_\+\+SA (\begin{DoxyParamCaption}\item[{struct rte\+\_\+mbuf $\ast$}]{pkt,  }\item[{uint16\+\_\+t}]{offset,  }\item[{struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$}]{isakmp\+\_\+hdr,  }\item[{struct rte\+\_\+ipv4\+\_\+hdr $\ast$}]{ipv4\+\_\+hdr }\end{DoxyParamCaption})}

Analyses a Security Association payload 
\begin{DoxyParams}{Parameters}
{\em pkt} & \+: pointer to packet used \\
\hline
{\em offset} & offset to paylaod header \\
\hline
{\em isakmp\+\_\+hdr} & pointer to isakmp headers \\
\hline
{\em ipv4\+\_\+hdr} & pointer to ipv4 headers \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if there are no errors analyzing the packet, 0 if otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a4efb58d15e0fc8def5b9b460204df033}\label{snart-1_80_2src_2ike_8c_a4efb58d15e0fc8def5b9b460204df033}} 
\index{ike.c@{ike.c}!analyse\_SK@{analyse\_SK}}
\index{analyse\_SK@{analyse\_SK}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{analyse\_SK()}{analyse\_SK()}}
{\footnotesize\ttfamily int analyse\+\_\+\+SK (\begin{DoxyParamCaption}\item[{struct rte\+\_\+mbuf $\ast$}]{pkt,  }\item[{uint16\+\_\+t}]{offset,  }\item[{struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$}]{isakmp\+\_\+hdr,  }\item[{struct rte\+\_\+ipv4\+\_\+hdr $\ast$}]{ipv4\+\_\+hdr }\end{DoxyParamCaption})}

Analyses a Authenticated and Encrypted payload. Note that whats inside cannot be analysed because it is encrypted 
\begin{DoxyParams}{Parameters}
{\em pkt} & \+: pointer to packet used \\
\hline
{\em offset} & offset to paylaod header \\
\hline
{\em isakmp\+\_\+hdr} & pointer to isakmp headers \\
\hline
{\em ipv4\+\_\+hdr} & pointer to ipv4 headers \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if there are no errors analyzing the packet, 0 if otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a8a2e4d2381a97d21c0ed7edf51f25bd3}\label{snart-1_80_2src_2ike_8c_a8a2e4d2381a97d21c0ed7edf51f25bd3}} 
\index{ike.c@{ike.c}!check\_if\_tunnel\_exists@{check\_if\_tunnel\_exists}}
\index{check\_if\_tunnel\_exists@{check\_if\_tunnel\_exists}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{check\_if\_tunnel\_exists()}{check\_if\_tunnel\_exists()}}
{\footnotesize\ttfamily int check\+\_\+if\+\_\+tunnel\+\_\+exists (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$}]{isakmp\+\_\+hdr,  }\item[{struct rte\+\_\+ipv4\+\_\+hdr $\ast$}]{ipv4\+\_\+hdr }\end{DoxyParamCaption})}

checks whether if ike information in tunnel actually exists 
\begin{DoxyParams}{Parameters}
{\em isakmp\+\_\+hdr} & isakmp header containing initiator and responder spis to check \\
\hline
{\em ipv4\+\_\+hdr} & I\+P\+V4 header containing respective ip addresses of client and host to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if information matches, 0 if otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a8dda2cc4ea685715608d01a5080022bd}\label{snart-1_80_2src_2ike_8c_a8dda2cc4ea685715608d01a5080022bd}} 
\index{ike.c@{ike.c}!check\_ike\_spi@{check\_ike\_spi}}
\index{check\_ike\_spi@{check\_ike\_spi}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{check\_ike\_spi()}{check\_ike\_spi()}}
{\footnotesize\ttfamily int check\+\_\+ike\+\_\+spi (\begin{DoxyParamCaption}\item[{uint64\+\_\+t}]{initiator\+\_\+spi,  }\item[{uint64\+\_\+t}]{responder\+\_\+spi,  }\item[{int}]{src\+\_\+addr,  }\item[{int}]{dst\+\_\+addr,  }\item[{struct \mbox{\hyperlink{structtunnel}{tunnel}} $\ast$}]{tunnel }\end{DoxyParamCaption})}

checks whether if ike information in tunnel matches provided spis and ip address \begin{DoxyReturn}{Returns}
1 if information matches, 0 if otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a4f2f0ec7403dcc0f2227f94c985daf56}\label{snart-1_80_2src_2ike_8c_a4f2f0ec7403dcc0f2227f94c985daf56}} 
\index{ike.c@{ike.c}!delete\_tunnel@{delete\_tunnel}}
\index{delete\_tunnel@{delete\_tunnel}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{delete\_tunnel()}{delete\_tunnel()}}
{\footnotesize\ttfamily void delete\+\_\+tunnel (\begin{DoxyParamCaption}\item[{uint64\+\_\+t}]{initiator\+\_\+spi,  }\item[{uint64\+\_\+t}]{responder\+\_\+spi,  }\item[{int}]{src\+\_\+addr,  }\item[{int}]{dst\+\_\+addr }\end{DoxyParamCaption})}

deletes tunnel from authenticated tunnels once session ends \mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a354dde6d2340e5858058e7834ef1113e}\label{snart-1_80_2src_2ike_8c_a354dde6d2340e5858058e7834ef1113e}} 
\index{ike.c@{ike.c}!get\_exchange\_type@{get\_exchange\_type}}
\index{get\_exchange\_type@{get\_exchange\_type}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{get\_exchange\_type()}{get\_exchange\_type()}}
{\footnotesize\ttfamily char$\ast$ get\+\_\+exchange\+\_\+type (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$}]{hdr }\end{DoxyParamCaption})}

Gets Exchange type of isakmp packet Should only be used if logging the exchange type is needed 
\begin{DoxyParams}{Parameters}
{\em hdr} & isakmp header of packet \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
String containing Exchange type of packet 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_aca25809fa65a72203c1a86df82023717}\label{snart-1_80_2src_2ike_8c_aca25809fa65a72203c1a86df82023717}} 
\index{ike.c@{ike.c}!get\_ike\_payload\_type@{get\_ike\_payload\_type}}
\index{get\_ike\_payload\_type@{get\_ike\_payload\_type}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{get\_ike\_payload\_type()}{get\_ike\_payload\_type()}}
{\footnotesize\ttfamily char$\ast$ get\+\_\+ike\+\_\+payload\+\_\+type (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$}]{hdr }\end{DoxyParamCaption})}

Gets Payload Type from a isakmp header as a string Should only be used if logging the payload type is needed 
\begin{DoxyParams}{Parameters}
{\em hdr} & isakmp header of packet \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a string containing the payload type 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a40bff66ff31f379f50f35fe368f5e149}\label{snart-1_80_2src_2ike_8c_a40bff66ff31f379f50f35fe368f5e149}} 
\index{ike.c@{ike.c}!get\_initiator\_flag@{get\_initiator\_flag}}
\index{get\_initiator\_flag@{get\_initiator\_flag}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{get\_initiator\_flag()}{get\_initiator\_flag()}}
{\footnotesize\ttfamily int get\+\_\+initiator\+\_\+flag (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$}]{isakmp\+\_\+hdr }\end{DoxyParamCaption})}

Gets initiator flag of a packet. If 1, means the packet is sent by the initiator else, the packet sent by the responder 
\begin{DoxyParams}{Parameters}
{\em isakmp\+\_\+hdr} & I\+K\+E/isakmp headers of the packet \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
initiator flag of the packet 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a46e5b81cb72db9afd48cf130849cb156}\label{snart-1_80_2src_2ike_8c_a46e5b81cb72db9afd48cf130849cb156}} 
\index{ike.c@{ike.c}!get\_ip\_address\_string@{get\_ip\_address\_string}}
\index{get\_ip\_address\_string@{get\_ip\_address\_string}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{get\_ip\_address\_string()}{get\_ip\_address\_string()}}
{\footnotesize\ttfamily void get\+\_\+ip\+\_\+address\+\_\+string (\begin{DoxyParamCaption}\item[{rte\+\_\+be32\+\_\+t}]{ip\+\_\+address,  }\item[{char $\ast$}]{ip }\end{DoxyParamCaption})}

converts ipv4 address into strings and place them in ip 
\begin{DoxyParams}{Parameters}
{\em ip\+\_\+address} & ipv4 address to convert \\
\hline
{\em ip} & char pointer to store the converted string \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a3f46e5ca9859c8654d91b889ac04c9f6}\label{snart-1_80_2src_2ike_8c_a3f46e5ca9859c8654d91b889ac04c9f6}} 
\index{ike.c@{ike.c}!get\_ipv6\_address\_string@{get\_ipv6\_address\_string}}
\index{get\_ipv6\_address\_string@{get\_ipv6\_address\_string}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{get\_ipv6\_address\_string()}{get\_ipv6\_address\_string()}}
{\footnotesize\ttfamily void get\+\_\+ipv6\+\_\+address\+\_\+string (\begin{DoxyParamCaption}\item[{struct rte\+\_\+ipv6\+\_\+hdr $\ast$}]{hdr,  }\item[{char $\ast$}]{src\+\_\+ip,  }\item[{char $\ast$}]{dst\+\_\+ip }\end{DoxyParamCaption})}

converts ipv6 address into strings and place them in ip 
\begin{DoxyParams}{Parameters}
{\em ip\+\_\+address} & ipv4 address to convert \\
\hline
{\em src\+\_\+ip} & char pointer to store the converted source ip string \\
\hline
{\em dst\+\_\+ip} & char pointer to store the converted destination ip string \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a90f5619eb873d81ae5ae37721698a5ea}\label{snart-1_80_2src_2ike_8c_a90f5619eb873d81ae5ae37721698a5ea}} 
\index{ike.c@{ike.c}!get\_nxt\_payload@{get\_nxt\_payload}}
\index{get\_nxt\_payload@{get\_nxt\_payload}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{get\_nxt\_payload()}{get\_nxt\_payload()}}
{\footnotesize\ttfamily char$\ast$ get\+\_\+nxt\+\_\+payload (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structisakmp__payload__hdr}{isakmp\+\_\+payload\+\_\+hdr}} $\ast$}]{hdr }\end{DoxyParamCaption})}

Gets Payload Type from a isakmp payload header as a string Should only be used if logging the payload type is needed 
\begin{DoxyParams}{Parameters}
{\em hdr} & isakmp header of packet \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a string containing the payload type 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a9a526d19c84f4e99f0b4460845258dfb}\label{snart-1_80_2src_2ike_8c_a9a526d19c84f4e99f0b4460845258dfb}} 
\index{ike.c@{ike.c}!get\_proposals@{get\_proposals}}
\index{get\_proposals@{get\_proposals}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{get\_proposals()}{get\_proposals()}}
{\footnotesize\ttfamily int get\+\_\+proposals (\begin{DoxyParamCaption}\item[{struct rte\+\_\+mbuf $\ast$}]{pkt,  }\item[{uint16\+\_\+t}]{offset,  }\item[{char $\ast$$\ast$$\ast$}]{proposals,  }\item[{int $\ast$}]{check }\end{DoxyParamCaption})}

Get proposals and transformations found in a SA payload 
\begin{DoxyParams}{Parameters}
{\em pkt} & pointer to packet being analyzed \\
\hline
{\em offset} & offset to SA hdr \\
\hline
{\em proposals} & string array containing proposals \\
\hline
{\em check} & int to check whether if packet is malformed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
number of proposals found 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a792b620aa4b8136af70a50f8bce857fe}\label{snart-1_80_2src_2ike_8c_a792b620aa4b8136af70a50f8bce857fe}} 
\index{ike.c@{ike.c}!get\_response\_flag@{get\_response\_flag}}
\index{get\_response\_flag@{get\_response\_flag}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{get\_response\_flag()}{get\_response\_flag()}}
{\footnotesize\ttfamily int get\+\_\+response\+\_\+flag (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$}]{hdr }\end{DoxyParamCaption})}

Gets response flag of a packet. If 1, means the packet is a response else, the packet is a request 
\begin{DoxyParams}{Parameters}
{\em hdr} & I\+K\+E/isakmp headers of the packet \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
response flag of the packet 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_ae5ac8407bb0a2effa8426c630f692914}\label{snart-1_80_2src_2ike_8c_ae5ac8407bb0a2effa8426c630f692914}} 
\index{ike.c@{ike.c}!get\_transformations@{get\_transformations}}
\index{get\_transformations@{get\_transformations}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{get\_transformations()}{get\_transformations()}}
{\footnotesize\ttfamily void get\+\_\+transformations (\begin{DoxyParamCaption}\item[{struct rte\+\_\+mbuf $\ast$}]{pkt,  }\item[{int}]{offset,  }\item[{int}]{size,  }\item[{char $\ast$}]{buf,  }\item[{int $\ast$}]{check }\end{DoxyParamCaption})}

Get Transformations found in a proposal and converts them into a string to log\+: 
\begin{DoxyParams}{Parameters}
{\em pkt} & pointer to packet to be analyzed \\
\hline
{\em transformations} & pointer to \mbox{\hyperlink{structArray}{Array}} contained in payload\+\_\+struc object \\
\hline
{\em offset} & Offset to transformation \\
\hline
{\em size} & Number of transformations \\
\hline
{\em buf} & string used to store transformations found \\
\hline
{\em check} & int to check whether if packet is malformed \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a71b42980feec6f86f3022ec85e95c49a}\label{snart-1_80_2src_2ike_8c_a71b42980feec6f86f3022ec85e95c49a}} 
\index{ike.c@{ike.c}!get\_version\_flag@{get\_version\_flag}}
\index{get\_version\_flag@{get\_version\_flag}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{get\_version\_flag()}{get\_version\_flag()}}
{\footnotesize\ttfamily int get\+\_\+version\+\_\+flag (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$}]{hdr }\end{DoxyParamCaption})}

Gets version flag of a packet. If 1, means the sender can use a higher version of I\+KE 
\begin{DoxyParams}{Parameters}
{\em hdr} & I\+K\+E/isakmp headers of the packet \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
version flag of the packet 
\end{DoxyReturn}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a90b40012e2e402c28879829f2f10a4fb}\label{snart-1_80_2src_2ike_8c_a90b40012e2e402c28879829f2f10a4fb}} 
\index{ike.c@{ike.c}!load\_tunnel@{load\_tunnel}}
\index{load\_tunnel@{load\_tunnel}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{load\_tunnel()}{load\_tunnel()}}
{\footnotesize\ttfamily void load\+\_\+tunnel (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Load save tunnels from file and add them to established tunnels. The tunnels will have their client\+\_\+loaded and host\+\_\+laoded flag set \mbox{\Hypertarget{snart-1_80_2src_2ike_8c_ac41f892693e060bc5b9eb439ceb338e1}\label{snart-1_80_2src_2ike_8c_ac41f892693e060bc5b9eb439ceb338e1}} 
\index{ike.c@{ike.c}!print\_isakmp\_headers\_info@{print\_isakmp\_headers\_info}}
\index{print\_isakmp\_headers\_info@{print\_isakmp\_headers\_info}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{print\_isakmp\_headers\_info()}{print\_isakmp\_headers\_info()}}
{\footnotesize\ttfamily void print\+\_\+isakmp\+\_\+headers\+\_\+info (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structrte__isakmp__hdr}{rte\+\_\+isakmp\+\_\+hdr}} $\ast$}]{isakmp\+\_\+hdr }\end{DoxyParamCaption})}

Used to print important ike header instructions, can be converted to write log into file if needed 
\begin{DoxyParams}{Parameters}
{\em isakmp\+\_\+hdr} & isakmp header of packet \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_ab0b298c3f8e167dd65ab193d8a3b5eae}\label{snart-1_80_2src_2ike_8c_ab0b298c3f8e167dd65ab193d8a3b5eae}} 
\index{ike.c@{ike.c}!remove\_tunnel@{remove\_tunnel}}
\index{remove\_tunnel@{remove\_tunnel}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{remove\_tunnel()}{remove\_tunnel()}}
{\footnotesize\ttfamily void remove\+\_\+tunnel (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structtunnel}{tunnel}} $\ast$}]{remove }\end{DoxyParamCaption})}

Remove tunnel from saved tunnel file 
\begin{DoxyParams}{Parameters}
{\em remove} & tunnel to remove \\
\hline
\end{DoxyParams}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_adafcb47aa03cf3507a3fdfe899d1001d}\label{snart-1_80_2src_2ike_8c_adafcb47aa03cf3507a3fdfe899d1001d}} 
\index{ike.c@{ike.c}!current\_time@{current\_time}}
\index{current\_time@{current\_time}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{current\_time}{current\_time}}
{\footnotesize\ttfamily char current\+\_\+time\mbox{[}21\mbox{]}}

\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_ae05dcdd7389336890e7d407337c207ed}\label{snart-1_80_2src_2ike_8c_ae05dcdd7389336890e7d407337c207ed}} 
\index{ike.c@{ike.c}!dst\_addr@{dst\_addr}}
\index{dst\_addr@{dst\_addr}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{dst\_addr}{dst\_addr}}
{\footnotesize\ttfamily char dst\+\_\+addr\mbox{[}16\mbox{]}}

\mbox{\Hypertarget{snart-1_80_2src_2ike_8c_a101d35b91670cc48b8670704e925e797}\label{snart-1_80_2src_2ike_8c_a101d35b91670cc48b8670704e925e797}} 
\index{ike.c@{ike.c}!src\_addr@{src\_addr}}
\index{src\_addr@{src\_addr}!ike.c@{ike.c}}
\doxysubsubsection{\texorpdfstring{src\_addr}{src\_addr}}
{\footnotesize\ttfamily char src\+\_\+addr\mbox{[}16\mbox{]}}

